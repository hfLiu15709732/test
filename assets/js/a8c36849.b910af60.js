"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1277],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>g});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var i=a.createContext({}),p=function(e){var t=a.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(i.Provider,{value:t},e.children)},m="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,i=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),m=p(n),u=o,g=m["".concat(i,".").concat(u)]||m[u]||c[u]||r;return n?a.createElement(g,l(l({ref:t},d),{},{components:n})):a.createElement(g,l({ref:t},d))}));function g(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,l=new Array(r);l[0]=u;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s[m]="string"==typeof e?e:o,l[1]=s;for(var p=2;p<r;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},3620:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>l,default:()=>c,frontMatter:()=>r,metadata:()=>s,toc:()=>p});var a=n(7462),o=(n(7294),n(3905));const r={slug:"Python_django_orm",title:"10. Django\u7684ORM\u673a\u5236",tags:["Python","Django","ORM"]},l="django\u6846\u67b6--ORM\u64cd\u4f5c",s={unversionedId:"Tech/python_server/Django-ORM\u64cd\u4f5c",id:"Tech/python_server/Django-ORM\u64cd\u4f5c",title:"10. Django\u7684ORM\u673a\u5236",description:"pip install mysqlclient",source:"@site/docs/Tech/python_server/10__Django-ORM\u64cd\u4f5c.mdx",sourceDirName:"Tech/python_server",slug:"/Tech/python_server/Python_django_orm",permalink:"/docs/Tech/python_server/Python_django_orm",draft:!1,editUrl:"https://github.com/hfLiu15709732/docs/Tech/python_server/10__Django-ORM\u64cd\u4f5c.mdx",tags:[{label:"Python",permalink:"/docs/tags/python"},{label:"Django",permalink:"/docs/tags/django"},{label:"ORM",permalink:"/docs/tags/orm"}],version:"current",sidebarPosition:10,frontMatter:{slug:"Python_django_orm",title:"10. Django\u7684ORM\u673a\u5236",tags:["Python","Django","ORM"]},sidebar:"techSidebar",previous:{title:"9. Django\u7684MVT\u4e0e\u540e\u53f0\u7ba1\u7406",permalink:"/docs/Tech/python_server/Python_mvt"},next:{title:"11. Django\u6846\u67b6\u5b8c\u5584",permalink:"/docs/Tech/python_server/Python_django_other"}},i={},p=[{value:"\u4e00.\u67b6\u6784\u642d\u5efa",id:"\u4e00\u67b6\u6784\u642d\u5efa",level:2},{value:"1.1 \u914d\u7f6e\u8fde\u63a5\u4fe1\u606f",id:"11-\u914d\u7f6e\u8fde\u63a5\u4fe1\u606f",level:3},{value:"1.2 \u6ce8\u518cAPP",id:"12-\u6ce8\u518capp",level:3},{value:"1.3 \u521b\u5efa\u6a21\u578b (model)",id:"13-\u521b\u5efa\u6a21\u578b-model",level:3},{value:"1.4 \u6a21\u578b\u8fc1\u79fb\uff08\u81ea\u52a8\u540c\u6b65\u6570\u636e\u5e93\uff09",id:"14-\u6a21\u578b\u8fc1\u79fb\u81ea\u52a8\u540c\u6b65\u6570\u636e\u5e93",level:3},{value:"\u4e8c.\u57fa\u7840\u64cd\u4f5c\uff08\u5355\u8868\uff09",id:"\u4e8c\u57fa\u7840\u64cd\u4f5c\u5355\u8868",level:2},{value:"2.1 \u589e\u52a0\u6570\u636e",id:"21-\u589e\u52a0\u6570\u636e",level:3},{value:"2.2 \u5220\u9664\u6570\u636e",id:"22-\u5220\u9664\u6570\u636e",level:3},{value:"2.3 \u4fee\u6539\u6570\u636e",id:"23-\u4fee\u6539\u6570\u636e",level:3},{value:"2.4 \u67e5\u8be2\u6570\u636e",id:"24-\u67e5\u8be2\u6570\u636e",level:3},{value:"2.5 JSON\u683c\u5f0f\u95ee\u9898",id:"25-json\u683c\u5f0f\u95ee\u9898",level:3},{value:"\u4e09.\u591a\u8868\u5b9e\u4f8b",id:"\u4e09\u591a\u8868\u5b9e\u4f8b",level:2},{value:"3.1 \u8bbe\u7f6e \u5916\u952e\uff08\u4e00\u5bf9\u591a\uff09/ \u4e00\u5bf9\u4e00 / \u591a\u5bf9\u591a\u7684\u5173\u7cfb\u95ee\u9898",id:"31-\u8bbe\u7f6e-\u5916\u952e\u4e00\u5bf9\u591a-\u4e00\u5bf9\u4e00--\u591a\u5bf9\u591a\u7684\u5173\u7cfb\u95ee\u9898",level:3},{value:"3.2 \u8fdb\u884c\u57fa\u672c\u67e5\u8be2",id:"32-\u8fdb\u884c\u57fa\u672c\u67e5\u8be2",level:3},{value:"3.3 \u5206\u7c7b\u67e5\u8be2\u4e0e\u805a\u5408\u67e5\u8be2",id:"33-\u5206\u7c7b\u67e5\u8be2\u4e0e\u805a\u5408\u67e5\u8be2",level:3},{value:"\u5206\u7c7b\u67e5\u8be2\uff1a",id:"\u5206\u7c7b\u67e5\u8be2",level:4},{value:"\u805a\u5408\u67e5\u8be2\uff1a",id:"\u805a\u5408\u67e5\u8be2",level:4},{value:"\u56db. \u6587\u6863\u5730\u5740",id:"\u56db-\u6587\u6863\u5730\u5740",level:2}],d={toc:p},m="wrapper";function c(e){let{components:t,...n}=e;return(0,o.kt)(m,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"django\u6846\u67b6--orm\u64cd\u4f5c"},"django\u6846\u67b6--ORM\u64cd\u4f5c"),(0,o.kt)("admonition",{title:"\u76f8\u5173\u4f9d\u8d56",type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"pip install mysqlclient")),(0,o.kt)("h2",{id:"\u4e00\u67b6\u6784\u642d\u5efa"},"\u4e00.\u67b6\u6784\u642d\u5efa"),(0,o.kt)("h3",{id:"11-\u914d\u7f6e\u8fde\u63a5\u4fe1\u606f"},"1.1 \u914d\u7f6e\u8fde\u63a5\u4fe1\u606f"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"DATABASES = {\n    'default': {\n    'ENGINE': 'django.db.backends.mysql',\n    'NAME':'day70',\n    'USER': 'eric',\n    'PASSWORD': '123123',\n    'HOST': '192.168.182.128',\n    'PORT': '3306',\n    }\n}\n")),(0,o.kt)("h3",{id:"12-\u6ce8\u518capp"},"1.2 \u6ce8\u518cAPP"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"INSTALLED_APPS = [\n    'django.contrib.admin',\n    'django.contrib.auth',\n    'django.contrib.contenttypes',\n    'django.contrib.sessions',\n    'django.contrib.messages',\n    'django.contrib.staticfiles',\n    'app01.apps.App01Config',\n   \n]\n")),(0,o.kt)("h3",{id:"13-\u521b\u5efa\u6a21\u578b-model"},"1.3 \u521b\u5efa\u6a21\u578b (model)"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"from django.db import models\n\n\nclass Student(models.Model):\n    name = models.CharField(max_length=32)\n    password = models.CharField(max_length=50)\n    age = models.IntegerField()\n\n    # def __str__(self):\n    #     return self.name\n\n\nclass dept(models.Model):\n    title = models.CharField(max_length=32)\n\n\n    # \u4e00\u4e2a\u8868\u5bf9\u5e94\u4e00\u4e2a\u7c7b\n\n")),(0,o.kt)("h3",{id:"14-\u6a21\u578b\u8fc1\u79fb\u81ea\u52a8\u540c\u6b65\u6570\u636e\u5e93"},"1.4 \u6a21\u578b\u8fc1\u79fb\uff08\u81ea\u52a8\u540c\u6b65\u6570\u636e\u5e93\uff09"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"python manage.py makemigrations  #\u6839\u636eapp\u4e0b\u7684migrations\u76ee\u5f55\u4e2d\u7684\u8bb0\u5f55\uff0c\u68c0\u6d4b\u5f53\u524dmodel\u5c42\u4ee3\u7801\u662f\u5426\u53d1\u751f\u53d8\u5316\uff1f\n\npython manage.py migrate         #\u628aorm\u4ee3\u7801\u8f6c\u6362\u6210sql\u8bed\u53e5\u53bb\u6570\u636e\u5e93\u6267\u884c\n")),(0,o.kt)("h2",{id:"\u4e8c\u57fa\u7840\u64cd\u4f5c\u5355\u8868"},"\u4e8c.\u57fa\u7840\u64cd\u4f5c\uff08\u5355\u8868\uff09"),(0,o.kt)("h3",{id:"21-\u589e\u52a0\u6570\u636e"},"2.1 \u589e\u52a0\u6570\u636e"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'def testInsert(request):\n    dept.objects.create(title="\u9500\u552e\u90e8")\n    dept.objects.create(title="\u751f\u4ea7\u90e8")\n    dept.objects.create(title="\u4ea7\u54c1\u90e8")\n    return HttpResponse("\u6dfb\u52a0\u6210\u529f")\n\n\n\ndef testInsert2(request):\n     obj = models.Tb1(idx=88, title=\'\u751f\u4ea7\u90e8\')\n     obj.save()\n     return HttpResponse("\u6dfb\u52a0\u6210\u529f")\n')),(0,o.kt)("h3",{id:"22-\u5220\u9664\u6570\u636e"},"2.2 \u5220\u9664\u6570\u636e"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'def testDelete(request):\n    dept.objects.filter(id=2).delete()   #id\u7ea6\u675f\u5220\u9664\n    dept.objects.all().delete()  # \u5168\u90e8\u6570\u636e\u5220\u9664\n    return HttpResponse("\u5220\u9664\u6210\u529f")\n\n')),(0,o.kt)("h3",{id:"23-\u4fee\u6539\u6570\u636e"},"2.3 \u4fee\u6539\u6570\u636e"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'def testUpdate(request):\n    dept.objects.filter(id=4).update(title="\u884c\u653f\u90e8")   #id\u7ea6\u675f\u4fee\u6539\n    dept.objects.all().update(title="\u5e02\u573a\u90e8") # \u5168\u90e8\u6570\u636e\u4fee\u6539\n    return HttpResponse("\u4fee\u6539\u6210\u529f")\n\n\n\ndef testUpdate2(request):\n     obj = models.dept.objects.get(id=4)\n     obj.title = \'\u884c\u653f\u90e8\'\n     obj.save()    \n\n')),(0,o.kt)("h3",{id:"24-\u67e5\u8be2\u6570\u636e"},"2.4 \u67e5\u8be2\u6570\u636e"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"def getBase(request):\n     models.dept.objects.get(id=11)           # \u83b7\u53d6\u5355\u6761\u6570\u636e\uff0c\u4e0d\u5b58\u5728\u5219\u62a5\u9519\uff08\u4e0d\u5efa\u8bae\uff09\n     models.dept.objects.all()                # \u83b7\u53d6\u5168\u90e8\u6570\u636e\n     models.dept.objects.filter(name='seven') # \u83b7\u53d6\u6307\u5b9a\u6761\u4ef6\u7684\u6570\u636e\n")),(0,o.kt)("h3",{id:"25-json\u683c\u5f0f\u95ee\u9898"},"2.5 JSON\u683c\u5f0f\u95ee\u9898"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'def querysetToJson(queryset):\n    listData=list(queryset.values())\n    jsonData=json.dumps(listData)\n    return jsonData\n\n\ndef JsonByteToList(bytes):\n\n    listData=json.loads(bytes)\n    return listData[\'data\']\n\n\n# \u63a7\u5236\u5668\u4e2d\u5e94\u7528tolist\u51fd\u6570\nlistData=JsonByteToList(request.body)\nfor obj in  listData:\n    print(obj)\n\n\n\n\n #\u4e5f\u53ef\u4ee5\u5411\u4e0b\u9762\u8fd9\u6837\u7684\u7b2c\u4e8c\u7c7b\u65b9\u6848\n    \n    dept_list=[]\n    for obj in  data_set:\n        dept_list.append({\n            "id":obj.id,\n            "title":obj.title\n        })\n    return JsonResponse(dept_list,safe=False)\n    \n')),(0,o.kt)("h2",{id:"\u4e09\u591a\u8868\u5b9e\u4f8b"},"\u4e09.\u591a\u8868\u5b9e\u4f8b"),(0,o.kt)("h3",{id:"31-\u8bbe\u7f6e-\u5916\u952e\u4e00\u5bf9\u591a-\u4e00\u5bf9\u4e00--\u591a\u5bf9\u591a\u7684\u5173\u7cfb\u95ee\u9898"},"3.1 \u8bbe\u7f6e \u5916\u952e\uff08\u4e00\u5bf9\u591a\uff09/ \u4e00\u5bf9\u4e00 / \u591a\u5bf9\u591a\u7684\u5173\u7cfb\u95ee\u9898"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'class Book(models.Model):\n\xa0 \xa0 title = models.CharField(max_length=32)\n\xa0 \xa0 price = models.DecimalField(max_digits=5, decimal_places=2)\n\xa0 \xa0 pub_date = models.DateField()\n\xa0 \xa0 publish = models.ForeignKey("Publish", on_delete=models.CASCADE) #\u8bbe\u7f6e\u4e00\u5bf9\u591a\u5173\u7cfb(\u5916\u952e)\n\xa0 \xa0 authors = models.ManyToManyField("Author")    #\u8bbe\u7f6e\u591a\u5bf9\u591a\u5173\u7cfb(MANY to MANY Field)\n\n\nclass Publish(models.Model):\n\xa0 \xa0 name = models.CharField(max_length=32)\n\xa0 \xa0 city = models.CharField(max_length=64)\n\xa0 \xa0 email = models.EmailField()\n\n\nclass Author(models.Model):\n\xa0 \xa0 name = models.CharField(max_length=32)\n\xa0 \xa0 age = models.SmallIntegerField()\n\xa0 \xa0 au_detail = models.OneToOneField("AuthorDetail", on_delete=models.CASCADE)\n    #\u8bbe\u7f6e\u4e00\u5bf9\u4e00\u5173\u7cfb(ONE to ONE Field)\n\n\nclass AuthorDetail(models.Model):\n\xa0 \xa0 gender_choices = (\n\xa0 \xa0 \xa0 \xa0 (0, "\u5973"),\n\xa0 \xa0 \xa0 \xa0 (1, "\u7537"),\n\xa0 \xa0 \xa0 \xa0 (2, "\u4fdd\u5bc6"),\n\xa0 \xa0 )\n\xa0 \xa0 gender = models.SmallIntegerField(choices=gender_choices)\n\xa0 \xa0 tel = models.CharField(max_length=32)\n\xa0 \xa0 addr = models.CharField(max_length=64)\n\xa0 \xa0 birthday = models.DateField()\n    \n    \n#  \u4e00\u5bf9\u591a\uff1amodels.ForeignKey(\u5176\u4ed6\u8868) \n#  \u591a\u5bf9\u591a\uff1amodels.ManyToManyField(\u5176\u4ed6\u8868)\n#  \u4e00\u5bf9\u4e00\uff1amodels.OneToOneField(\u5176\u4ed6\u8868)\n')),(0,o.kt)("h3",{id:"32-\u8fdb\u884c\u57fa\u672c\u67e5\u8be2"},"3.2 \u8fdb\u884c\u57fa\u672c\u67e5\u8be2"),(0,o.kt)("admonition",{title:"\u6ce8\u610f",type:"danger"},(0,o.kt)("p",{parentName:"admonition"},"\u57fa\u672c\u4fe1\u606f\u521b\u5efa\u597d\u4e4b\u540e ORM\u4f1a\u81ea\u52a8\u5206\u914d\u60f3\u7684ID\u4e3b\u952e\u53ca\u5176\u5404\u4e2a\u8868\u4e4b\u95f4\u7684\u4e3b\u5916\u952e\u4e0e\u8fde\u63a5\u5173\u7cfb "),(0,o.kt)("p",{parentName:"admonition"},"\u6240\u4ee5\u5f00\u53d1\u8005\u76f4\u63a5\u6839\u636e\u9700\u6c42\u5199\u5c31\u884c\u4e86(\u4ec5\u4ec5\u53bb\u64cd\u4f5cModel\u6765\u95f4\u63a5\u64cd\u4f5c\u6570\u636e\u5e93)")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u56db\u4e2a\u5178\u578b\u4f8b\u5b50\uff1a")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"\u4e00\u5bf9\u4e00\u5173\u7cfb\u67e5\u8be2\uff1a"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'# \u67e5\u8be2\u4f5c\u8005\u540d\u4e3a"John"\u7684\u4f5c\u8005\u8be6\u60c5\nauthor_detail = AuthorDetail.objects.get(author__name="John")\nprint(author_detail.gender, author_detail.tel)\n')),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"\u4e00\u5bf9\u591a\u5173\u7cfb\u67e5\u8be2\uff1a"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'# \u67e5\u8be2\u51fa\u7248\u793e\u540d\u4e3a"ABC\u51fa\u7248\u793e"\u7684\u6240\u6709\u56fe\u4e66\nbooks = Book.objects.filter(publish__name="ABC\u51fa\u7248\u793e")\nfor book in books:\n    print(book.title, book.price)\n')),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"\u591a\u5bf9\u591a\u5173\u7cfb\u67e5\u8be2\uff1a"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'# \u67e5\u8be2\u4f5c\u8005\u540d\u4e3a"John"\u7684\u6240\u6709\u56fe\u4e66\nbooks = Book.objects.filter(authors__name="John")\nfor book in books:\n    print(book.title, book.price)\n')),(0,o.kt)("ol",{start:4},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"\u666e\u901a\u67e5\u8be2\uff1a"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"# \u67e5\u8be2\u4ef7\u683c\u5927\u4e8e100\u7684\u6240\u6709\u56fe\u4e66\nbooks = Book.objects.filter(price__gt=100)\nfor book in books:\n    print(book.title, book.price)\n")),(0,o.kt)("h3",{id:"33-\u5206\u7c7b\u67e5\u8be2\u4e0e\u805a\u5408\u67e5\u8be2"},"3.3 \u5206\u7c7b\u67e5\u8be2\u4e0e\u805a\u5408\u67e5\u8be2"),(0,o.kt)("h4",{id:"\u5206\u7c7b\u67e5\u8be2"},"\u5206\u7c7b\u67e5\u8be2\uff1a"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"\u67e5\u8be2\u6bcf\u4e2a\u51fa\u7248\u793e\u51fa\u7248\u7684\u56fe\u4e66\u6570\u91cf\uff1a"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"from django.db.models import Count\n\npublishers = Publish.objects.annotate(num_books=Count('book'))\nfor publisher in publishers:\n    print(publisher.name, publisher.num_books)\n")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"\u67e5\u8be2\u6bcf\u4e2a\u4f5c\u8005\u5199\u7684\u56fe\u4e66\u6570\u91cf\uff1a")),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-python"},"authors = Author.objects.annotate(num_books=Count('book'))\nfor author in authors:\n    print(author.name, author.num_books)\n")))),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"\u67e5\u8be2\u6bcf\u4e2a\u4f5c\u8005\u7684\u5e73\u5747\u5e74\u9f84\uff1a"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"from django.db.models import Avg\n\nauthors = Author.objects.annotate(avg_age=Avg('age'))\nfor author in authors:\n    print(author.name, author.avg_age)\n")),(0,o.kt)("h4",{id:"\u805a\u5408\u67e5\u8be2"},"\u805a\u5408\u67e5\u8be2\uff1a"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"\u8ba1\u7b97\u56fe\u4e66\u7684\u5e73\u5747\u4ef7\u683c\uff1a")),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-python"},"from django.db.models import Avg\n\naverage_price = Book.objects.aggregate(avg_price=Avg('price'))\nprint(average_price['avg_price'])\n")))),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"\u8ba1\u7b97\u56fe\u4e66\u7684\u603b\u4ef7\u683c\uff1a")),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-python"},"from django.db.models import Sum\n\ntotal_price = Book.objects.aggregate(sum_price=Sum('price'))\nprint(total_price['sum_price'])\n")))),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"\u8ba1\u7b97\u6bcf\u4e2a\u4f5c\u8005\u7684\u56fe\u4e66\u603b\u4ef7\u683c\uff1a"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"from django.db.models import Sum\n\nauthors = Author.objects.annotate(total_price=Sum('book__price'))\nfor author in authors:\n    print(author.name, author.total_price)\n")),(0,o.kt)("h2",{id:"\u56db-\u6587\u6863\u5730\u5740"},"\u56db. \u6587\u6863\u5730\u5740"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://rvni3p1fr2r.feishu.cn/wiki/S9pDw5OzYiHcwpkP5wncJsK3nvg?from=from_copylink"},"Django\u6846\u67b6--ORM\u64cd\u4f5c")))}c.isMDXComponent=!0}}]);